"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[784],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=p(n),d=o,h=m["".concat(l,".").concat(d)]||m[d]||c[d]||r;return n?a.createElement(h,i(i({ref:t},u),{},{components:n})):a.createElement(h,i({ref:t},u))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var p=2;p<r;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4540:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var a=n(7462),o=(n(7294),n(3905));const r={slug:"rfc",title:"Request for Comments",authors:["evanbacon"],tags:["release"]},i=void 0,s={permalink:"/router/blog/rfc",source:"@site/blog/2022-09-22-beta.md",title:"Request for Comments",description:"Users have been building powerful apps with Expo for years now. Over the last few years, we've focused on solving many foundational issues with native development like code signing, compiling native binaries, upgrading complex projects, and publishing to the app stores. Thanks to Expo Application Services we've been able to create a solid foundation for building powerful native apps in a continuous and reliable way.",date:"2022-09-22T00:00:00.000Z",formattedDate:"September 22, 2022",tags:[{label:"release",permalink:"/router/blog/tags/release"}],readingTime:7.045,hasTruncateMarker:!1,authors:[{name:"Evan Bacon",title:"Creator of Expo Router",url:"https://twitter.com/baconbrix",imageURL:"https://github.com/evanbacon.png",key:"evanbacon"}],frontMatter:{slug:"rfc",title:"Request for Comments",authors:["evanbacon"],tags:["release"]}},l={authorsImageUrls:[void 0]},p=[{value:"Goals",id:"goals",level:2},{value:"Example",id:"example",level:2},{value:"Without Expo Router",id:"without-expo-router",level:3},{value:"With Expo Router",id:"with-expo-router",level:3},{value:"Request for Comments",id:"request-for-comments",level:2},{value:"Getting Started",id:"getting-started",level:2}],u={toc:p};function c(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Users have been building powerful apps with Expo for years now. Over the last few years, we've focused on solving many foundational issues with native development like code signing, compiling native binaries, upgrading complex projects, and publishing to the app stores. Thanks to Expo Application Services we've been able to create a solid foundation for building powerful native apps in a continuous and reliable way."),(0,o.kt)("p",null,"Now we want to provide developers with a framework for creating drastically better experiences for end users."),(0,o.kt)("p",null,"Since ",(0,o.kt)("a",{parentName:"p",href:"https://twitter.com/Baconbrix/status/1384355891772739584?s=20&t=uRredgRat4ORWTmjd-Jf3g"},"April 2021"),", I've been working on a new router that generates nested navigation and deep links based entirely on the project's file system. The concept of a file system-based router is not new to web developers (PHP, Next.js, etc.), but it is ",(0,o.kt)("strong",{parentName:"p"},"brand new")," to mobile developers! By bringing this foundational paradigm to mobile, we move closer to matching the shareability, and scalability of the web in native apps."),(0,o.kt)("h2",{id:"goals"},"Goals"),(0,o.kt)("p",null,"There are many applications for the new routing system. The first problems we want to tackle are as follows:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Make it fast and easy to create, maintain, and scale apps with nested native navigation.")),(0,o.kt)("p",null,"Websites are most often based on the concept of pages and links. Each page is a file in the project's file system. Each link is a URL. This is a very simple and powerful concept that has been used for decades. It's also a concept that has been adopted by many modern web frameworks like Next.js, Gatsby, and Nuxt.js."),(0,o.kt)("p",null,"This paradigm is intuitive and powerful because developers can easily create, move, and delete pages, without having to worry about manually importing, linking, and connecting screens to each other. The framework handles the routing and navigation for you."),(0,o.kt)("p",null,"Expo router works the same way, you focus on creating the content of the pages and designing the layouts. The framework handles the rest automatically."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Making any part of the app instantly shareable via deep links.")),(0,o.kt)("p",null,"Tooling can also optimize the app in many ways. For example, a framework can generate deep links for each page and link. This enables the app to be opened from a URL or a push notification. It also you to share any part of the app instantly with anyone--a feature that is often reserved for projects with massive teams and budgets."),(0,o.kt)("p",null,"Imagine if you wanted to share a photo with a friend so you sent them a link to instagram.com and told them to search around until they find the exact page you were talking about. That's how sharing works in most apps today. It's not a great experience."),(0,o.kt)("p",null,"The web has solved this problem for decades by associating every page with a URL that can be instantly shared and visited by anyone. We plan to bring this same flexibility to mobile apps via Expo router."),(0,o.kt)("p",null,"Because Expo is multi-platform, you can develop your routes once and share them across iOS, Android, and the web. This means you can utilize the built-in URL handling of the browser to quickly build out your native apps routes."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Building apps that are fast, reliable, and work offline-first.")),(0,o.kt)("p",null,"Unlike the web, native apps must always work offline-first. This means that the app must be able to handle any incoming URL without a network connection or server. This is a very difficult problem to solve and requires a lot of tooling and infrastructure to make it work while feeling native."),(0,o.kt)("p",null,"The hardest part of this process was creating a performant system for making native apps using JavaScript, e.g. React Native with the Expo SDK. Everything else could be implemented using advanced CLI and bundler techniques which we implemented using the bundler built for ridiculous scale: Metro."),(0,o.kt)("p",null,"The end-user experience is fast and light-weight, and the developer experience is equally fast utilizing universal Fast Refresh, incremental bundling, and intelligent artifact memoization."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Handling errors and data fetching states in a consistent way.")),(0,o.kt)("p",null,"One of the most exciting parts of React is the ability to atomize your app's UI and data fetching into reusable components. Web-only frameworks have been able to take advantage of this for years, but we've yet to see a React Native framework that could provide the same experience."),(0,o.kt)("p",null,"Expo router has the ability to set up React Error Boundaries for each route (Suspense boundaries coming in a later version). This means that you can easily handle errors and data fetching states in a consistent way across the entire app and retry failed requests."),(0,o.kt)("p",null,"This is a large departure from the traditional approach to handling errors in a native app: throwing a fatal error and crashing the app with no indication of what went wrong. This is a terrible user experience and something we're excited to move away from."),(0,o.kt)("p",null,"This initial version of the Expo router just scratches the surface of data fetching and error handling. We can implement smart component-based React Suspense boundaries, data fetching hooks, font/asset loading, and automated splash screen orchestration in the future."),(0,o.kt)("h2",{id:"example"},"Example"),(0,o.kt)("p",null,"The following is a simple example of migrating a single-screen app with the next easiest native framework React Navigation, to Expo Router:"),(0,o.kt)("h3",{id:"without-expo-router"},"Without Expo Router"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"For the sake of brevity, I've omitted the many dependency installations and native ",(0,o.kt)("a",{parentName:"p",href:"https://reactnavigation.org/docs/deep-linking/#set-up-with-bare-react-native-projects"},"Xcode / Android Studio steps")," required when working without Expo. This example also doesn't account for hiding the splash screen after navigation has mounted.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="HomeScreen.js"',title:'"HomeScreen.js"'},'import { View, Text } from "react-native";\n\nexport default function HomeScreen() {\n  return (\n    <View style={{ flex: 1, alignItems: "center", justifyContent: "center" }}>\n      <Text>Home Screen</Text>\n    </View>\n  );\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="App.js"',title:'"App.js"'},'import { NavigationContainer } from "@react-navigation/native";\nimport { createNativeStackNavigator } from "@react-navigation/native-stack";\nimport * as Linking from "expo-linking";\n\nimport HomeScreen from "./HomeScreen";\n\nconst Stack = createNativeStackNavigator();\n\nconst prefix = Linking.createURL("/");\n\nconst linking = {\n  prefixes: [prefix],\n  config: {\n    // Deep link configuration\n    home: {\n      // Must be updated to match the screens in the project\n      path: "/home",\n      screens: {},\n    },\n  },\n};\n\nexport default function App() {\n  return (\n    <NavigationContainer linking={linking}>\n      <Stack.Navigator>\n        <Stack.Screen name="home" component={HomeScreen} />\n      </Stack.Navigator>\n    </NavigationContainer>\n  );\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="index.js"',title:'"index.js"'},'import { AppRegistry } from "react-native";\nimport App from "./App";\n\nAppRegistry.registerComponent("main", () => App);\n')),(0,o.kt)("h3",{id:"with-expo-router"},"With Expo Router"),(0,o.kt)("p",null,"Simply create a file in the ",(0,o.kt)("strong",{parentName:"p"},"app")," directory, and export a React component. The framework will automatically generate the navigation and deep links for you, instantly with Fast Refresh."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="app/home.tsx"',title:'"app/home.tsx"'},'import { View, Text } from "react-native";\n\nfunction HomeScreen() {\n  return (\n    <View style={{ flex: 1, alignItems: "center", justifyContent: "center" }}>\n      <Text>Home Screen</Text>\n    </View>\n  );\n}\n')),(0,o.kt)("p",null,"Optionally you can also set up a custom native scheme (otherwise the native app identifier will be used):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="app.json"',title:'"app.json"'},'{\n    "expo": {\n        "scheme": "acme",\n    }\n}\n')),(0,o.kt)("p",null,"You can now start the app and visit the ",(0,o.kt)("inlineCode",{parentName:"p"},"/home")," route on any device. I recommend using ",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/uri-scheme"},(0,o.kt)("inlineCode",{parentName:"a"},"uri-scheme"))," to test deep links on iOS and Android."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Platform"),(0,o.kt)("th",{parentName:"tr",align:null},"URL"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"iOS"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"acme://home"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Android"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"acme://home"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"web"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"https://acme.com/home"))))),(0,o.kt)("p",null,"As you can imagine, this scales nicely and is very easy to maintain. You can create as many pages as you want, and the framework will automatically generate the navigation and deep links for you."),(0,o.kt)("h2",{id:"request-for-comments"},"Request for Comments"),(0,o.kt)("p",null,"We're excited to share the early beta of the Expo router with you today. We want to hear your feedback and help us push the boundaries of what's possible with mobile development!"),(0,o.kt)("p",null,"We're looking for feedback on the following:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"API Design"),": Specifically the routing convention and layouts API. We want to make sure the API is intuitive and easy to use."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Tooling and workflow"),": We want to make sure the tooling is fast and easy to use. We also want to make sure the workflow is intuitive and easy to understand, this is especially true for navigating URLs on a native device where there is no URL bar."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Performance"),': We want to make sure the app is fast and reliable. We also want to make sure the app is small and lightweight. We\'re currently focused on "make it work" with "make it fast" features like code splitting, bundle splitting, and lazy loading coming in a future version. The file system-based router enables us to implement many performance optimizations behind the scenes without the need to refactor in the future.')),(0,o.kt)("h2",{id:"getting-started"},"Getting Started"),(0,o.kt)("p",null,"To get started, refer to the ",(0,o.kt)("a",{parentName:"p",href:"https://expo.github.io/router"},"Expo router documentation"),". Please report bugs and issues on the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/expo/router"},"Expo router GitHub repository"),"."))}c.isMDXComponent=!0}}]);